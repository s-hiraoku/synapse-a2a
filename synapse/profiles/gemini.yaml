command: "gemini"
args: []
submit_sequence: "\r"
startup_delay: 8
env:
  TERM: "xterm-256color"

# Multi-strategy idle detection configuration
# Gemini: Use hybrid strategy - pattern for first idle (UI ready), timeout for subsequent
# BRACKETED_PASTE_MODE indicates the TUI input area is ready to receive input
idle_detection:
  strategy: "hybrid"
  pattern: "BRACKETED_PASTE_MODE"  # ESC[?2004h = TUI input ready
  pattern_use: "startup_only"      # Only use pattern for first READY detection
  timeout: 3.0                     # 3.0 seconds of no output = idle (after first)

# Input ready detection for initial instructions
# Wait for this pattern before sending instructions to ensure TUI is ready
input_ready_pattern: ">"                       # Gemini shows > in input box when ready

# WAITING status detection (user input prompts)
# DISABLED: Current regex-based detection causes false positives
# where WAITING status gets stuck because patterns remain in output buffer
# See: https://github.com/s-hiraoku/synapse-a2a/issues/140
# waiting_detection:
#   regex: "[●○]\\s+\\d+\\.|Allow (execution|once|for this session)"
#   require_idle: true
#   idle_timeout: 0.5
