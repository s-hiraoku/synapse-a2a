# 外部A2Aエージェント連携ビジョン

**作成日**: 2025-12-30
**ステータス**: Vision Document

---

## 概要

Synapse A2A は現在、ローカルCLIエージェント（Claude CLI、Gemini CLI等）をA2Aプロトコルでラップしています。将来的には、外部のA2A対応サービスやエージェントとも接続し、より広いエコシステムに参加することを目指します。

```
┌─────────────────────────────────────────────────────────────┐
│                                                              │
│   Local CLI Agents          Synapse A2A          External   │
│  ┌──────────────┐         ┌───────────┐         A2A Agents │
│  │ Claude CLI   │◄───────►│           │◄───────►┌────────┐ │
│  │ Gemini CLI   │  PTY    │  Gateway  │  HTTPS  │ SaaS   │ │
│  │ Codex CLI    │         │  + Auth   │  A2A    │ B2B    │ │
│  └──────────────┘         └───────────┘         │ IoT    │ │
│                                                  └────────┘ │
│                                                              │
└─────────────────────────────────────────────────────────────┘
```

---

## ユースケース

### 1. SaaS/クラウドサービス連携

各SaaSがA2Aエンドポイントを公開すれば、自然言語でサービス間連携が可能になります。

```
┌─────────────────────────────────────────────────────────────┐
│                   External A2A Ecosystem                     │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  ┌──────────────┐                                           │
│  │ Synapse A2A  │                                           │
│  │ (Your Local) │                                           │
│  └──────┬───────┘                                           │
│         │ A2A Protocol                                       │
│         │                                                    │
│    ┌────┴────┬──────────┬──────────┬──────────┐            │
│    ▼         ▼          ▼          ▼          ▼            │
│ ┌──────┐ ┌──────┐ ┌────────┐ ┌────────┐ ┌────────┐        │
│ │Figma │ │Notion│ │Salesforce│ │ Jira  │ │GitHub │        │
│ │Agent │ │Agent │ │  Agent  │ │ Agent │ │Copilot│        │
│ └──────┘ └──────┘ └────────┘ └────────┘ └────────┘        │
│                                                              │
└─────────────────────────────────────────────────────────────┘
```

**例**:
```
User: "新機能の要件をまとめて"

Claude: @notion-agent "プロジェクトXの要件ドキュメントを取得"
        @figma-agent "関連するデザインモックを取得"
        @jira-agent "関連チケットのステータスを確認"

        → 統合して要件サマリーを生成
```

**期待されるサービス**:
- プロジェクト管理: Jira, Asana, Linear
- ドキュメント: Notion, Confluence, Google Docs
- デザイン: Figma, Sketch
- コミュニケーション: Slack, Teams
- CRM: Salesforce, HubSpot
- 開発: GitHub, GitLab, Bitbucket

---

### 2. 企業間（B2B）コラボレーション

A2Aプロトコルを介して、異なる企業のエージェント同士が安全に通信できます。

```
┌─────────────────────────────────────────────────────────────┐
│              B2B Agent Communication                         │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│   Your Company                    Partner Company            │
│  ┌────────────┐                  ┌────────────┐             │
│  │ Your Agent │ ◄── A2A/mTLS ──► │Partner Agent│             │
│  └────────────┘                  └────────────┘             │
│                                                              │
│  "在庫確認して"      ───────►    "在庫: 500個"              │
│  "発注: 100個"       ───────►    "受注確認: #12345"         │
│                                                              │
└─────────────────────────────────────────────────────────────┘
```

**ユースケース**:
- サプライチェーン連携（発注・在庫確認・納期調整）
- パートナーAPIの自然言語インターフェース
- 契約・見積もりの自動交渉
- 共同プロジェクトでのタスク調整

**必要な要件**:
- mTLS による相互認証
- 監査ログ
- SLA/契約の取り決め

---

### 3. エージェントマーケットプレイス

専門的なサービスを提供するA2Aエージェントのマーケットプレイスが登場する可能性があります。

```
┌─────────────────────────────────────────────────────────────┐
│              Agent Marketplace                               │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  Agent Registry (Public)                                     │
│  ├── @legal-expert.lawfirm.com    (法務レビュー)            │
│  ├── @translator.service.io       (多言語翻訳)              │
│  ├── @data-analyst.analytics.com  (データ分析)              │
│  ├── @security-audit.sec.io       (セキュリティ監査)        │
│  └── @tax-advisor.accounting.com  (税務アドバイス)          │
│                                                              │
└─────────────────────────────────────────────────────────────┘
```

**例**:
```
Claude: "@legal-expert.lawfirm.com この契約書をレビューして"
        → 従量課金で専門サービスを利用
```

**課金モデル候補**:
- リクエスト単位
- トークン/文字数単位
- 月額サブスクリプション
- 成果報酬型

---

### 4. IoT / エッジデバイス連携

A2Aプロトコルを介して物理デバイスを制御する可能性があります。

```
┌─────────────────────────────────────────────────────────────┐
│              Physical World Integration                      │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  Claude: "@smart-home.local 照明を暗くして"                  │
│          "@factory-robot.plant1 ラインBを停止"               │
│          "@drone-fleet.field センサーデータ収集して"         │
│                                                              │
│         ┌─────────┐  ┌─────────┐  ┌─────────┐              │
│         │ Home    │  │ Factory │  │ Drone   │              │
│         │ Gateway │  │ PLC     │  │ Control │              │
│         └─────────┘  └─────────┘  └─────────┘              │
│                                                              │
└─────────────────────────────────────────────────────────────┘
```

**考慮事項**:
- リアルタイム性の要件
- 安全性（物理的影響）
- オフライン対応
- プロトコル変換（MQTT, OPC-UA等）

---

### 5. 専門AIモデル連携

汎用AIから専門AIへタスクを委譲するパターンです。

```
┌─────────────────────────────────────────────────────────────┐
│              Specialized AI Models                           │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  汎用 Claude ──┬──► @medical-ai.health.io (医療診断支援)    │
│               ├──► @legal-ai.law.io (判例検索)              │
│               ├──► @code-review.dev.io (静的解析)           │
│               └──► @vision-ai.cv.io (画像認識)              │
│                                                              │
│  "このX線画像を分析して" → @medical-ai に委譲               │
│  "このコードの脆弱性は？" → @code-review に委譲             │
│                                                              │
└─────────────────────────────────────────────────────────────┘
```

**メリット**:
- 専門分野での精度向上
- ライセンス・規制対応（医療、法務等）
- コスト最適化（必要な時だけ専門モデル使用）

---

### 6. 政府・公共サービス連携

政府機関がA2Aエンドポイントを公開するシナリオです。

```
想定される公開A2Aエージェント:
├── @patent-search.gov      特許検索
├── @company-registry.gov   法人登記情報
├── @weather.gov            気象データ
├── @statistics.gov         統計データ
└── @tax-filing.gov         税務申告
```

**例**:
```
"新しい特許を出願したい"
  → @patent-search.gov で先行技術調査
  → 結果をもとに出願書類ドラフト作成
```

---

## 実現可能性と時間軸

### 実現可能性マトリクス

| ユースケース | 技術的実現性 | 現実の課題 | 予想時間軸 |
|-------------|-------------|-----------|-----------|
| SaaS連携 | ✅ 可能 | 各社のA2A対応 | 1-3年 |
| B2B連携 | ✅ 可能 | 信頼・契約・セキュリティ | 2-5年 |
| 専門AIモデル | ✅ 可能 | 課金モデル、品質保証 | 1-2年 |
| IoT/エッジ | ⚠️ 部分的 | リアルタイム性、プロトコル | 3-5年 |
| 公共サービス | ⚠️ 部分的 | 法整備、認証基盤 | 5年+ |

### エコシステム成熟の条件

```
A2Aエコシステムの成熟に必要なもの:

1. 主要AIプロバイダーの採用
   └─ Google: 発表済み (2025年4月)
   └─ Anthropic, OpenAI: 未発表

2. SaaSベンダーのA2A対応
   └─ 現状: REST API主流、A2A対応はほぼゼロ

3. Agent Discovery の標準化
   └─ Agent Cardは定義済み、発見メカニズムが未確立

4. 認証・課金の標準
   └─ OAuth/API Keyベースになる見込み
```

### 現実的なシナリオ

**短期 (2025)**:
- 自社内での複数エージェント連携
- 自作A2Aサービスとの接続実験
- プロトコルの理解と準備

**中期 (2026-2027)**:
- 主要AIプロバイダーがA2A対応
- 一部SaaSがA2Aエンドポイント提供開始
- 初期のマーケットプレイス登場

**長期 (2028+)**:
- A2Aがデファクト標準に
- 多様なエージェントマーケットプレイス
- B2B/B2Gでの広範な採用

---

## Synapse A2A の戦略的ポジション

### 現在の価値

```
┌─────────────────────────────────────────────────────────────┐
│  Synapse A2A の現在の役割                                    │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  1. ローカルCLIツールのA2Aラッパー                          │
│     └─ Claude CLI, Gemini CLI等をA2A対応に                  │
│                                                              │
│  2. A2Aプロトコルの学習・実験環境                           │
│     └─ 実際に動くA2A実装での理解                            │
│                                                              │
│  3. 社内マルチエージェント環境                              │
│     └─ 複数AIの協調動作の検証                               │
│                                                              │
└─────────────────────────────────────────────────────────────┘
```

### 将来の価値

```
┌─────────────────────────────────────────────────────────────┐
│  エコシステム成熟後の Synapse A2A                            │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  1. ゲートウェイ                                            │
│     └─ ローカルCLIと外部A2Aを橋渡し                         │
│                                                              │
│  2. 認証・ルーティングハブ                                  │
│     └─ どのエージェントと通信するかの制御                   │
│                                                              │
│  3. プライバシー境界                                        │
│     └─ 何を外部に出すか/出さないかの制御                    │
│                                                              │
│  4. 既存システムのA2A化                                     │
│     └─ 社内ツール/APIをA2Aエンドポイントとして公開          │
│                                                              │
└─────────────────────────────────────────────────────────────┘
```

### 今A2A準拠を進める理由

1. **即座に接続可能**: エコシステムが成熟したら待たずに参加
2. **実験・検証**: 社内での安全な環境でマルチエージェント検証
3. **プロトコル理解**: 実装を通じた深い理解
4. **フィードバック**: 仕様策定への貢献可能性

---

## 技術的準備

### 外部接続に必要な機能 (Phase 3)

| 機能 | 目的 | 設計書 |
|------|------|--------|
| 認証・認可 | 外部サービスとの信頼確立 | [ロードマップ](../tasks/a2a/wrapper-improvements.md) |
| HTTPS/mTLS | セキュアな通信 | [A2A仕様](../guides/google-a2a-spec.md) |
| Agent Discovery | 外部エージェントの発見 | 今後設計 |
| Rate Limiting | 外部からのアクセス制御 | 今後設計 |

### 外部A2Aエージェントの登録

現在の `ExternalAgentRegistry` で外部エージェントを登録可能:

```python
# 外部エージェントの登録例
from synapse.a2a_client import A2AClient

client = A2AClient(registry)
client.discover("https://external-agent.example.com")
# → Agent Card を取得して登録
```

---

## 関連ドキュメント

- [A2A設計思想と準拠性分析](./a2a-design-rationale.md)
- [ラッパー改善ロードマップ](../tasks/a2a/wrapper-improvements.md)
- [Google A2A 仕様ガイド](../guides/google-a2a-spec.md)
- [Google A2A 仕様（公式）](https://google.github.io/A2A/)
